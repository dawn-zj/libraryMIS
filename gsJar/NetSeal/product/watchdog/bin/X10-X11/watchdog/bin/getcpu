#!/bin/bash
totala=`head -1 /proc/stat |awk '{printf "%.f\n",$2+$3+$4+$5+$6+$7+$8}'`
#echo $totala
idlea=`head -1 /proc/stat |awk '{print $5}'`
#echo $idlea
sleep 0.5
totalb=`head -1 /proc/stat |awk '{printf "%.f\n",$2+$3+$4+$5+$6+$7+$8}'`
idleb=`head -1 /proc/stat |awk '{print $5}'`
total=$[$totalb - $totala]
idle=$[$idleb-$idlea]
usage=`expr 100 - $idle \* 100 / $total`
echo "$usage"

